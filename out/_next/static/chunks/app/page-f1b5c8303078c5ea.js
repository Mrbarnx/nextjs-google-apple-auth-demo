(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1206:function(e,t,o){Promise.resolve().then(o.bind(o,4413))},4413:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return d}});var s=o(7437),n=o(2265),i=o(6463),r=o(5735),a=o(7552);let l="true"===String("true").toLowerCase(),c="authAttemptProvider",u="lastProvider";function d(){let e=(0,i.useRouter)(),[t,o]=(0,n.useState)("idle"),[d,p]=(0,n.useState)("Idle"),[g,m]=(0,n.useState)(!1),[w,h]=(0,n.useState)(!1),[f,v]=(0,n.useState)([]),S=(0,n.useMemo)(()=>"status status-".concat(t),[t]),b=e=>{let t=new Date().toLocaleTimeString();v(o=>{let s=["".concat(t," - ").concat(e),...o].slice(0,20);return window.sessionStorage.setItem("authDebugLines",JSON.stringify(s)),s})};(0,n.useEffect)(()=>{let t;let s=window.sessionStorage.getItem("authDebugLines");if(s)try{v(JSON.parse(s))}catch(e){}b("Page loaded at ".concat(window.location.origin).concat(window.location.pathname));let n=new URL(window.location.href);if("1"===n.searchParams.get("appleMockRedirect")){let t={providerId:"apple.com",mock:!0,user:{uid:"apple-mock-uid",email:"mock-apple-user@example.com",displayName:"Mock Apple User"}};console.log("Apple sign-up result (MOCK):",t),b("Apple mock redirect result received"),o("success"),p("Success (Apple mock)"),window.sessionStorage.setItem("mockAppleUser",JSON.stringify(t.user)),n.searchParams.delete("appleMockRedirect"),window.history.replaceState({},"",n.toString()),e.push("/dashboard");return}let i=()=>{};try{t=(0,a.y)(),h(!0),b("Firebase auth initialized")}catch(e){console.error("Firebase config error:",e),b("Firebase config error: ".concat((null==e?void 0:e.message)||"unknown")),o("error"),p("Missing Firebase config");return}return i=(0,r.Aj)(t,t=>{t?(b("Auth state user found: ".concat(t.email||t.uid)),e.replace("/dashboard")):b("Auth state: no active user")}),(0,r.cx)(t).then(t=>{var s,n,i;if(!t){b("No redirect result returned");let e=window.sessionStorage.getItem(c);e&&(o("error"),p("Redirect session lost after ".concat(e," sign-in")),b("Redirect session lost for ".concat(e)),window.sessionStorage.removeItem(c),window.sessionStorage.removeItem(u));return}let r=window.sessionStorage.getItem(u)||"unknown";console.log("".concat(r," sign-up result:"),{providerId:t.providerId,uid:null===(s=t.user)||void 0===s?void 0:s.uid,email:null===(n=t.user)||void 0===n?void 0:n.email,displayName:null===(i=t.user)||void 0===i?void 0:i.displayName}),o("success"),p("Success (".concat(r,")")),window.sessionStorage.removeItem(c),window.sessionStorage.removeItem(u),window.sessionStorage.removeItem("authDebugLines"),b("".concat(r," redirect result success")),e.replace("/dashboard")}).catch(e=>{console.error("Redirect sign-up error:",e),b("Redirect error: ".concat((null==e?void 0:e.code)||(null==e?void 0:e.message)||"unknown")),o("error"),p((null==e?void 0:e.message)||"Authentication failed"),window.sessionStorage.removeItem(c),window.sessionStorage.removeItem(u)}).finally(()=>m(!1)),()=>i()},[e]);let k=async()=>{if(!g&&w)try{m(!0),o("loading"),p("Redirecting with Google..."),b("Google button clicked");let e=(0,a.y)();await (0,r.Fb)(e,r.a$),b("Auth persistence set to local");let t=new r.hJ;window.sessionStorage.setItem(c,"Google"),window.sessionStorage.setItem(u,"Google"),b("Calling signInWithRedirect for Google"),await (0,r.F6)(e,t)}catch(e){console.error("Google sign-up start error:",e),b("Google start error: ".concat((null==e?void 0:e.code)||(null==e?void 0:e.message)||"unknown")),o("error"),p((null==e?void 0:e.message)||"Failed to start Google sign-up"),m(!1)}},I=async()=>{if(!g){if(l){m(!0),o("loading"),p("Redirecting with Apple (mock)..."),b("Apple mock button clicked"),window.sessionStorage.setItem(c,"Apple"),window.sessionStorage.setItem(u,"Apple"),window.location.assign("".concat(window.location.pathname,"?appleMockRedirect=1"));return}if(w)try{m(!0),o("loading"),p("Redirecting with Apple..."),b("Apple real button clicked");let e=(0,a.y)();await (0,r.Fb)(e,r.a$);let t=new r.O4("apple.com");window.sessionStorage.setItem(c,"Apple"),window.sessionStorage.setItem(u,"Apple"),b("Calling signInWithRedirect for Apple"),await (0,r.F6)(e,t)}catch(e){console.error("Apple sign-up start error:",e),b("Apple start error: ".concat((null==e?void 0:e.code)||(null==e?void 0:e.message)||"unknown")),o("error"),p((null==e?void 0:e.message)||"Failed to start Apple sign-up"),m(!1)}}};return(0,s.jsx)("main",{className:"page",children:(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("h1",{className:"title",children:"Create your account"}),(0,s.jsx)("p",{className:"subtitle",children:"Choose a sign-up method"}),(0,s.jsxs)("div",{className:"buttonStack",children:[(0,s.jsx)("button",{type:"button",className:"authButton googleBtn",disabled:g||!w,onClick:k,children:"Continue with Google"}),(0,s.jsx)("button",{type:"button",className:"authButton appleBtn",disabled:g||!w&&!l,onClick:I,children:"Continue with Apple"})]}),(0,s.jsx)("p",{className:S,children:d}),(0,s.jsx)("p",{className:"hint",children:"Redirect flow only, no popup windows."}),(0,s.jsxs)("p",{className:"hint",children:["Debug: ready=",String(w)," busy=",String(g)]}),(0,s.jsx)("div",{className:"hint",style:{marginTop:"8px",maxHeight:"140px",overflow:"auto"},children:f.map(e=>(0,s.jsx)("div",{children:e},e))})]})})}},7552:function(e,t,o){"use strict";o.d(t,{y:function(){return r}});var s=o(5236),n=o(5735);let i={apiKey:"AIzaSyCkwBJiQcsFu0QDtI9Kt-VS5purXhWonvw",authDomain:"oauth-f23ff.firebaseapp.com",projectId:"oauth-f23ff",appId:"1:229309869251:web:7300e912972ba6ccdd8676"};function r(){!function(){let e=Object.entries(i).filter(e=>{let[,t]=e;return!t}).map(e=>{let[t]=e;return t});if(e.length>0)throw Error("Missing Firebase env vars: ".concat(e.join(", ")))}();let e=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)(i);return(0,n.v0)(e)}}},function(e){e.O(0,[990,661,971,23,744],function(){return e(e.s=1206)}),_N_E=e.O()}]);